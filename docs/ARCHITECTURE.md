# Архитектура — RegexHelper

Краткий указатель архитектурной документации по инструментам.

---

## Инструменты

| Инструмент | Документ | Описание |
|------------|----------|----------|
| **Конвертер** | [docs/converter/ARCHITECTURE.md](converter/ARCHITECTURE.md) | Поток данных, ключевые модули, UI, зависимые converters. |
| **Визуализатор** | [docs/visualizer/ARCHITECTURE.md](visualizer/ARCHITECTURE.md) | Интеграция с regexper-static; кнопка «Скачать» с выпадающим меню (SVG/PNG); зум и Ctrl+колёсико; адаптивная высота области (has-diagram); модалка на весь экран; патч отступов бандла. |
| **Регистр** | [docs/case/ARCHITECTURE.md](case/ARCHITECTURE.md) | Конвертер регистра текста (модальное окно из навигации): режимы, логика, интеграция, сброс, тесты. |
| **Тестер** | [docs/tester/ARCHITECTURE.md](tester/ARCHITECTURE.md) | Проверка regex на тестовой строке: Python (emulated), флаги, Worker с таймаутом, подсветка в поле, Match Information. |

---

## Импорт паттернов (Reverse Converter)

**Модуль:** `tools/converter/logic/regexParser.js`

Функционал позволяет импортировать готовые regex-паттерны в визуальный конструктор:

### Как работает
1. **Кнопка «Импорт паттерна»** в шапке панели «Связанные триггеры»
2. Открывается модальное окно с текстовым полем
3. Пользователь вставляет regex-паттерн
4. В реальном времени отображается анализ: подсветка ошибок, предупреждения, статистика
5. При нажатии «Импорт» паттерн разбирается в структуру триггеров/групп

### Обратный маппинг (Reverse Mapping)
Парсер распознаёт regex-конструкции и восстанавливает параметры конструктора:

| Regex | → | Параметр |
|-------|---|----------|
| `[её]` | → | `ё` (автозамена) |
| `[ьъ]` | → | `ь` (автозамена) |
| `оо?` | → | `оо` (автоудвоение) |
| `но?к` | → | `нок` + optionalChars на `о` |
| `[аa]` | → | `а` + latinCyrillic |
| `[рr][оo][бb]` | → | `роб` + transliteration |
| `\\b...\\b` | → | wordBoundaries: true |
| `...\\s` | → | requireSpaceAfter: true |
| `слово\\w{1,3}` | → | wildcard: {min:1, max:3} |
| `[\s\S]+` | → | connector: any |
| `.+` | → | connector: paragraph |
| `[^\n]+` | → | connector: line |
| `.{0,20}` | → | connector: custom |

### Предупреждения
Нераспознанные конструкции (пользовательские символьные классы, lookahead и т.д.) подсвечиваются в модалке и добавляются как предупреждения. Импорт разрешён даже при наличии предупреждений.

---

## Общее

- **core/** — конфигурация, иконки, общие стили.
- **shared/** — утилиты (storage, validation, escape), UI (notifications, feedback), контент (WIKI).
- **tools/\<инструмент\>/** — logic, ui, css для каждого инструмента.

### Форма обратной связи (Feedback)

Модуль `shared/ui/feedback.js` реализует форму обратной связи для пользователей:
- Кнопка «Фидбек» в хедере открывает модальное окно
- Типы сообщений: баг, предложение, вопрос, другое
- Отправка через Supabase Edge Function → Telegram
- Honeypot-защита от спама
- Публичный endpoint без авторизации (--no-verify-jwt)

Граф зависимостей: **docs/DEPENDENCY_MAP.md**. Принципы разработки: **docs/PROJECT_PRINCIPLES.md**.
